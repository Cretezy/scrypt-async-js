/*!
 * Fast "async" scrypt implementation in JavaScript.
 * Copyright (c) 2013-2014 Dmitry Chestnykh | BSD License
 * https://github.com/dchest/scrypt-async-js
 */
function scrypt(r,n,t,o,e,f,u,a){"use strict";function c(r){function n(r){for(var n=0,p=r.length;p>=64;){var l,v,g,y,w,d=o,A=e,b=f,m=u,I=a,j=c,x=h,E=i;for(v=0;16>v;v++)g=n+4*v,s[v]=(255&r[g])<<24|(255&r[g+1])<<16|(255&r[g+2])<<8|255&r[g+3];for(v=16;64>v;v++)l=s[v-2],y=(l>>>17|l<<15)^(l>>>19|l<<13)^l>>>10,l=s[v-15],w=(l>>>7|l<<25)^(l>>>18|l<<14)^l>>>3,s[v]=0|(0|y+s[v-7])+(0|w+s[v-16]);for(v=0;64>v;v++)y=0|(0|((I>>>6|I<<26)^(I>>>11|I<<21)^(I>>>25|I<<7))+(I&j^~I&x))+(0|E+(0|t[v]+s[v])),w=0|((d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+(d&A^d&b^A&b),E=x,x=j,j=I,I=0|m+y,m=b,b=A,A=d,d=0|y+w;o=0|o+d,e=0|e+A,f=0|f+b,u=0|u+m,a=0|a+I,c=0|c+j,h=0|h+x,i=0|i+E,n+=64,p-=64}}var t=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=1779033703,e=3144134277,f=1013904242,u=2773480762,a=1359893119,c=2600822924,h=528734635,i=1541459225,s=new Array(64);n(r);var p,l=63&r.length,v=8*r.length,g=56>l?60:124,y=r.slice(r.length-l,r.length);for(y.push(128),p=l+1;g>p;p++)y.push(0);return y.push(255&v>>>24),y.push(255&v>>>16),y.push(255&v>>>8),y.push(255&v>>>0),n(y),[255&o>>>24,255&o>>>16,255&o>>>8,255&o>>>0,255&e>>>24,255&e>>>16,255&e>>>8,255&e>>>0,255&f>>>24,255&f>>>16,255&f>>>8,255&f>>>0,255&u>>>24,255&u>>>16,255&u>>>8,255&u>>>0,255&a>>>24,255&a>>>16,255&a>>>8,255&a>>>0,255&c>>>24,255&c>>>16,255&c>>>8,255&c>>>0,255&h>>>24,255&h>>>16,255&h>>>8,255&h>>>0,255&i>>>24,255&i>>>16,255&i>>>8,255&i>>>0]}function h(r,n,t){function o(){for(var r=f-1;r>=f-4;r--){if(u[r]++,u[r]<=255)return;u[r]=0}}r=r.length<=64?r:c(r);var e,f=64+n.length+4,u=new Array(f),a=new Array(64),h=[];for(e=0;64>e;e++)u[e]=54;for(e=0;e<r.length;e++)u[e]^=r[e];for(e=0;e<n.length;e++)u[64+e]=n[e];for(e=f-4;f>e;e++)u[e]=0;for(e=0;64>e;e++)a[e]=92;for(e=0;e<r.length;e++)a[e]^=r[e];for(;t>=32;)o(),h=h.concat(c(a.concat(c(u)))),t-=32;return t>0&&(o(),h=h.concat(c(a.concat(c(u))).slice(0,t))),h}function i(r,n,t,o){var e,f,u=r[0]^n[t++],a=r[1]^n[t++],c=r[2]^n[t++],h=r[3]^n[t++],i=r[4]^n[t++],s=r[5]^n[t++],p=r[6]^n[t++],l=r[7]^n[t++],v=r[8]^n[t++],g=r[9]^n[t++],y=r[10]^n[t++],w=r[11]^n[t++],d=r[12]^n[t++],A=r[13]^n[t++],b=r[14]^n[t++],m=r[15]^n[t++],I=u,j=a,x=c,E=h,C=i,N=s,T=p,k=l,q=v,z=g,B=y,D=w,F=d,G=A,H=b,J=m;for(f=0;8>f;f+=2)e=I+F,C^=e<<7|e>>>25,e=C+I,q^=e<<9|e>>>23,e=q+C,F^=e<<13|e>>>19,e=F+q,I^=e<<18|e>>>14,e=N+j,z^=e<<7|e>>>25,e=z+N,G^=e<<9|e>>>23,e=G+z,j^=e<<13|e>>>19,e=j+G,N^=e<<18|e>>>14,e=B+T,H^=e<<7|e>>>25,e=H+B,x^=e<<9|e>>>23,e=x+H,T^=e<<13|e>>>19,e=T+x,B^=e<<18|e>>>14,e=J+D,E^=e<<7|e>>>25,e=E+J,k^=e<<9|e>>>23,e=k+E,D^=e<<13|e>>>19,e=D+k,J^=e<<18|e>>>14,e=I+E,j^=e<<7|e>>>25,e=j+I,x^=e<<9|e>>>23,e=x+j,E^=e<<13|e>>>19,e=E+x,I^=e<<18|e>>>14,e=N+C,T^=e<<7|e>>>25,e=T+N,k^=e<<9|e>>>23,e=k+T,C^=e<<13|e>>>19,e=C+k,N^=e<<18|e>>>14,e=B+z,D^=e<<7|e>>>25,e=D+B,q^=e<<9|e>>>23,e=q+D,z^=e<<13|e>>>19,e=z+q,B^=e<<18|e>>>14,e=J+H,F^=e<<7|e>>>25,e=F+J,G^=e<<9|e>>>23,e=G+F,H^=e<<13|e>>>19,e=H+G,J^=e<<18|e>>>14;n[o++]=r[0]=0|I+u,n[o++]=r[1]=0|j+a,n[o++]=r[2]=0|x+c,n[o++]=r[3]=0|E+h,n[o++]=r[4]=0|C+i,n[o++]=r[5]=0|N+s,n[o++]=r[6]=0|T+p,n[o++]=r[7]=0|k+l,n[o++]=r[8]=0|q+v,n[o++]=r[9]=0|z+g,n[o++]=r[10]=0|B+y,n[o++]=r[11]=0|D+w,n[o++]=r[12]=0|F+d,n[o++]=r[13]=0|G+A,n[o++]=r[14]=0|H+b,n[o++]=r[15]=0|J+m}function s(r,n,t,o,e){for(;e--;)r[n++]=t[o++]}function p(r,n,t,o,e){for(;e--;)r[n++]^=t[o++]}function l(r,n,t,o,e){s(r,0,n,t+16*(2*e-1),16);for(var f=0;2*e>f;f+=2)i(r,n,t+16*f,o+8*f),i(r,n,t+16*f+16,o+8*f+16*e)}function v(r,n,t){return r[n+16*(2*t-1)]}function g(r){for(var n=[],t=0;t<r.length;t++){var o=r.charCodeAt(t);128>o?n.push(o):o>127&&2048>o?(n.push(192|o>>6),n.push(128|63&o)):(n.push(224|o>>12),n.push(128|63&o>>6),n.push(128|64&o))}return n}function y(r){for(var n="0123456789abcdef".split(""),t=r.length,o=[],e=0;t>e;e++)o.push(n[15&r[e]>>>4]),o.push(n[15&r[e]>>>0]);return o.join("")}function w(r){for(var n,t,o,e,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),u=r.length,a=[],c=0;u>c;)n=u>c?r[c++]:0,t=u>c?r[c++]:0,o=u>c?r[c++]:0,e=(n<<16)+(t<<8)+o,a.push(f[63&e>>>18]),a.push(f[63&e>>>12]),a.push(f[63&e>>>6]),a.push(f[63&e>>>0]);return u%3>0&&(a[a.length-1]="=",1==u%3&&(a[a.length-2]="=")),a.join("")}function d(){for(var r=0;32*o>r;r++){var n=4*r;x[q+r]=(255&C[n+3])<<24|(255&C[n+2])<<16|(255&C[n+1])<<8|(255&C[n+0])<<0}}function A(r,n){for(var t=r;n>t;t+=2)s(E,t*32*o,x,q,32*o),l(N,x,q,z,o),s(E,(t+1)*32*o,x,z,32*o),l(N,x,z,q,o)}function b(r,n){for(var t=r;n>t;t+=2){var e=v(x,q,o)&k-1;p(x,q,E,e*32*o,32*o),l(N,x,q,z,o),e=v(x,z,o)&k-1,p(x,z,E,e*32*o,32*o),l(N,x,z,q,o)}}function m(){for(var r=0;32*o>r;r++){var n=x[q+r];C[4*r+0]=255&n>>>0,C[4*r+1]=255&n>>>8,C[4*r+2]=255&n>>>16,C[4*r+3]=255&n>>>24}}function I(r,n,t,o,e){!function f(){setTimeout(function(){o(r,n>r+t?r+t:n),r+=t,n>r?f():e()},0)}()}var j=1;if(1>t||t>31)throw new Error("scrypt: logN not be between 1 and 31");var x,E,C,N,T=1<<31>>>0,k=1<<t>>>0;if(o*j>=1<<30||o>T/128/j||o>T/256||k>T/128/o)throw new Error("scrypt: parameters are too large");"string"==typeof r&&(r=g(r)),"string"==typeof n&&(n=g(n)),"undefined"!=typeof Int32Array?(x=new Int32Array(64*o),E=new Int32Array(32*k*o),N=new Int32Array(16)):(x=[],E=[],N=new Array(16)),C=h(r,n,128*j*o);var q=0,z=32*o;f||(f=1e3),d(),I(0,k,2*f,A,function(){I(0,k,2*f,b,function(){m();var n=h(r,C,e);"base64"==a?u(w(n)):"hex"==a?u(y(n)):u(n)})})}"undefined"!=typeof module&&(module.exports=scrypt);